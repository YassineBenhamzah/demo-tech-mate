import{c as k,u as B,r as c,D as a,j as e,B as o,T as C,S as N,C as R,I as d,P as A,M as q,a as M,b as x}from"./index-BGJdic0U.js";import{C as y}from"./circle-check-big-B7rIDG8o.js";import{S as P}from"./search-BepPDWoY.js";import{C as V,D as G}from"./download-B6k-a_dC.js";import{F as O}from"./funnel-CVF-cb4q.js";import{M as z}from"./map-pin-DHUOw5nZ.js";/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],F=k("clock",_),W=()=>{const{deliveries:u,updateDeliveryStatus:D,addDelivery:L,clients:h}=B(),[i,p]=c.useState("all"),[j,S]=c.useState(""),[E,m]=c.useState(!1),[b,f]=c.useState(""),[s,l]=c.useState({date:new Date().toISOString().split("T")[0],address:"",driver:"",itemsCount:1}),g=u.filter(t=>{const r=t.clientName.toLowerCase().includes(j.toLowerCase())||t.reference.toLowerCase().includes(j.toLowerCase()),n=i==="all"?!0:i==="pending"?t.status===a.PENDING||t.status===a.IN_TRANSIT:t.status===a.DELIVERED||t.status===a.CANCELLED;return r&&n}),I=t=>{switch(t){case a.PENDING:return e.jsx(x,{color:"yellow",children:"En attente"});case a.IN_TRANSIT:return e.jsx(x,{color:"blue",children:"En cours"});case a.DELIVERED:return e.jsx(x,{color:"green",children:"Livré"});case a.CANCELLED:return e.jsx(x,{color:"red",children:"Annulé"});default:return e.jsx(x,{color:"gray",children:t})}},w=t=>{const r=t.target.value;f(r);const n=h.find(v=>v.id===r);n&&l(v=>({...v,address:n.address||""}))},T=t=>{t.preventDefault();const r=h.find(n=>n.id===b);r&&(L({clientName:r.company||r.name,date:s.date,address:s.address,driver:s.driver,itemsCount:s.itemsCount}),m(!1),f(""),l({date:new Date().toISOString().split("T")[0],address:"",driver:"",itemsCount:1}))};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Livraisons (BL)"}),e.jsx("p",{className:"text-slate-500",children:"Gestion des expéditions et suivis de livraison"})]}),e.jsx("div",{className:"flex gap-2",children:e.jsx(o,{icon:C,onClick:()=>m(!0),children:"Nouveau Bon de Livraison"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx(N,{title:"En attente",value:u.filter(t=>t.status===a.PENDING).length.toString(),icon:F,color:"yellow"}),e.jsx(N,{title:"Livrés ce mois",value:u.filter(t=>t.status===a.DELIVERED).length.toString(),icon:y,color:"green",trend:"+12%",trendUp:!0}),e.jsx(N,{title:"Total Expéditions",value:u.length.toString(),icon:C,color:"blue"})]}),e.jsx("div",{className:"border-b border-slate-200",children:e.jsxs("nav",{className:"-mb-px flex gap-6",children:[e.jsx("button",{onClick:()=>p("all"),className:`pb-4 px-2 text-sm font-medium border-b-2 transition-colors ${i==="all"?"border-brand-600 text-brand-600":"border-transparent text-slate-500 hover:text-slate-700"}`,children:"Tous les BL"}),e.jsx("button",{onClick:()=>p("pending"),className:`pb-4 px-2 text-sm font-medium border-b-2 transition-colors ${i==="pending"?"border-brand-600 text-brand-600":"border-transparent text-slate-500 hover:text-slate-700"}`,children:"En cours / À livrer"}),e.jsx("button",{onClick:()=>p("history"),className:`pb-4 px-2 text-sm font-medium border-b-2 transition-colors ${i==="history"?"border-brand-600 text-brand-600":"border-transparent text-slate-500 hover:text-slate-700"}`,children:"Historique"})]})}),e.jsxs(R,{className:"p-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-6",children:[e.jsx("div",{className:"flex-1",children:e.jsx(d,{placeholder:"Rechercher par client ou référence BL...",icon:P,value:j,onChange:t=>S(t.target.value)})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(o,{variant:"outline",icon:V,children:"Date"}),e.jsx(o,{variant:"outline",icon:O,children:"Statut"})]})]}),e.jsx("div",{className:"overflow-x-auto rounded-lg border border-slate-200",children:e.jsxs("table",{className:"w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-slate-50 text-slate-700 font-semibold",children:e.jsxs("tr",{children:[e.jsx("th",{className:"py-4 px-4",children:"Référence"}),e.jsx("th",{className:"py-4 px-4",children:"Date"}),e.jsx("th",{className:"py-4 px-4",children:"Client"}),e.jsx("th",{className:"py-4 px-4",children:"Lieu de Livraison"}),e.jsx("th",{className:"py-4 px-4 text-center",children:"Colis/Articles"}),e.jsx("th",{className:"py-4 px-4 text-center",children:"Statut"}),e.jsx("th",{className:"py-4 px-4 text-right",children:"Actions"})]})}),e.jsxs("tbody",{className:"divide-y divide-slate-100 bg-white",children:[g.map(t=>e.jsxs("tr",{className:"hover:bg-slate-50 transition-colors",children:[e.jsx("td",{className:"py-4 px-4",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-medium text-brand-600 cursor-pointer",children:t.reference}),t.quoteReference&&e.jsxs("span",{className:"text-xs text-slate-400",children:["Via ",t.quoteReference]})]})}),e.jsx("td",{className:"py-4 px-4 text-slate-500",children:t.date}),e.jsx("td",{className:"py-4 px-4 font-medium text-slate-900",children:t.clientName}),e.jsx("td",{className:"py-4 px-4 text-slate-500",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(z,{size:14,className:"text-slate-400"}),e.jsx("span",{className:"truncate max-w-[200px]",title:t.address,children:t.address})]})}),e.jsx("td",{className:"py-4 px-4 text-center",children:e.jsxs("div",{className:"inline-flex items-center gap-1 bg-slate-100 px-2 py-1 rounded text-slate-600 text-xs font-medium",children:[e.jsx(A,{size:12})," ",t.itemsCount]})}),e.jsx("td",{className:"py-4 px-4 text-center",children:I(t.status)}),e.jsx("td",{className:"py-4 px-4 text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{className:"text-slate-400 hover:text-brand-600 transition-colors",title:"Télécharger BL",children:e.jsx(G,{size:18})}),t.status!==a.DELIVERED&&e.jsx("button",{onClick:()=>D(t.id,a.DELIVERED),className:"text-slate-400 hover:text-emerald-600 transition-colors",title:"Marquer Livré",children:e.jsx(y,{size:18})})]})})]},t.id)),g.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"py-8 text-center text-slate-500",children:"Aucun bon de livraison trouvé."})})]})]})})]}),e.jsx(q,{isOpen:E,onClose:()=>m(!1),title:"Créer un Bon de Livraison",children:e.jsxs("form",{onSubmit:T,className:"space-y-4",children:[e.jsxs(M,{label:"Client",value:b,onChange:w,required:!0,children:[e.jsx("option",{value:"",children:"Sélectionner un client"}),h.map(t=>e.jsx("option",{value:t.id,children:t.company||t.name},t.id))]}),e.jsx(d,{label:"Date de Livraison",type:"date",required:!0,value:s.date,onChange:t=>l({...s,date:t.target.value})}),e.jsx(d,{label:"Adresse de Livraison",required:!0,value:s.address,onChange:t=>l({...s,address:t.target.value})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(d,{label:"Chauffeur / Livreur",placeholder:"Nom du livreur",value:s.driver,onChange:t=>l({...s,driver:t.target.value})}),e.jsx(d,{label:"Nombre de Colis",type:"number",min:"1",required:!0,value:s.itemsCount,onChange:t=>l({...s,itemsCount:parseInt(t.target.value)})})]}),e.jsxs("div",{className:"pt-4 flex justify-end gap-2",children:[e.jsx(o,{type:"button",variant:"outline",onClick:()=>m(!1),children:"Annuler"}),e.jsx(o,{type:"submit",children:"Générer BL"})]})]})})]})};export{W as Logistics};
